# 数据库监控系统 - 待实现功能清单

## 🔴 高优先级功能

### 1. SQL详情弹窗 ⭐⭐⭐⭐⭐
**描述**: 点击SQL记录查看完整详情
**包含**:
- 完整SQL文本（不截断）
- 会话详细信息
- 执行计划
- 性能指标
- Kill会话按钮

**数据库字段已支持**: ✅ sql_fulltext, execution_plan

### 2. 执行计划分析 ⭐⭐⭐⭐⭐
**描述**: 自动获取并展示SQL执行计划
**功能**:
- MySQL: EXPLAIN分析
- SQL Server: 执行计划XML
- 执行计划可视化展示
- 索引使用情况
- 全表扫描检测

**数据库字段已支持**: ✅ execution_plan, index_used, full_table_scan

### 3. Kill会话功能 ⭐⭐⭐⭐
**描述**: 终止长时间运行的SQL
**功能**:
- MySQL: KILL <session_id>
- SQL Server: KILL <spid>
- 确认对话框
- 操作日志记录

### 4. SQL指纹/去重 ⭐⭐⭐⭐
**描述**: 相同模板的SQL只记录一次代表性样本
**功能**:
- 自动生成SQL指纹（MD5）
- 参数值替换为占位符
- 相同指纹的SQL合并展示
- 显示执行次数

**数据库字段已支持**: ✅ sql_fingerprint

## 🟡 中优先级功能

### 5. 告警历史记录 ⭐⭐⭐
**描述**: 记录已发送的告警，避免重复告警
**功能**:
- 告警发送历史表
- 告警间隔控制
- 告警发送状态标记

**数据库字段已支持**: ✅ alert_sent

### 6. 实时监控仪表板 ⭐⭐⭐
**描述**: 实时显示当前正在运行的SQL
**功能**:
- WebSocket实时推送
- 当前活动会话列表
- 实时性能指标
- 自动刷新

### 7. SQL历史趋势 ⭐⭐⭐
**描述**: 某个SQL指纹的历史执行趋势
**功能**:
- 执行次数趋势
- 平均耗时趋势
- 性能劣化检测

### 8. 性能指标采集 ⭐⭐⭐
**描述**: 采集更详细的性能指标
**功能**:
- CPU时间
- 逻辑读/物理读
- 扫描行数/返回行数
- 查询成本

**数据库字段已支持**: ✅ cpu_time, logical_reads, physical_reads, rows_examined, rows_sent, query_cost

## 🟢 低优先级功能

### 9. SQL优化建议 ⭐⭐
**描述**: 基于执行计划给出优化建议
**功能**:
- 索引建议
- SQL重写建议
- 表结构优化建议

### 10. 定时任务调度 ⭐⭐
**描述**: 内置任务调度器
**功能**:
- 替代crontab
- Web界面配置采集间隔
- 任务执行历史

### 11. 报表导出 ⭐⭐
**描述**: 导出监控报表
**功能**:
- Excel导出
- PDF报表
- 自定义时间范围

### 12. 多租户支持 ⭐
**描述**: 支持多个团队独立使用
**功能**:
- 用户登录
- 权限管理
- 数据隔离

## 📊 当前数据库表已支持但未使用的字段

| 字段名 | 用途 | 优先级 |
|--------|------|--------|
| sql_fingerprint | SQL指纹 | ⭐⭐⭐⭐ |
| sql_fulltext | 完整SQL文本 | ⭐⭐⭐⭐⭐ |
| execution_plan | 执行计划JSON | ⭐⭐⭐⭐⭐ |
| index_used | 使用的索引 | ⭐⭐⭐⭐ |
| full_table_scan | 全表扫描标记 | ⭐⭐⭐⭐ |
| cpu_time | CPU时间 | ⭐⭐⭐ |
| logical_reads | 逻辑读取数 | ⭐⭐⭐ |
| physical_reads | 物理读取数 | ⭐⭐⭐ |
| rows_examined | 扫描行数 | ⭐⭐⭐ |
| rows_sent | 返回行数 | ⭐⭐⭐ |
| query_cost | 查询成本 | ⭐⭐⭐ |
| alert_sent | 告警发送标记 | ⭐⭐⭐ |

## 🎯 推荐实现顺序

1. **第一批**: SQL详情弹窗 + 执行计划分析 + Kill会话（完善核心功能）
2. **第二批**: SQL指纹去重 + 性能指标采集（提升数据质量）
3. **第三批**: 告警历史记录 + 实时仪表板（增强用户体验）
4. **第四批**: 其他功能按需实现
